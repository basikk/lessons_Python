<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>Курс Python 9 клас | Головна</title>
<link rel="stylesheet" href="css/style.css">
<style>
body { font-family: Arial, sans-serif; margin: 0; height: 100vh; display: flex; }
#sidebar { width: 300px; background: #f4f4f4; padding: 20px; overflow-y: auto; border-right: 1px solid #ccc; }
#content { flex: 1; padding: 20px; overflow-y: auto; }
h1, h2 { color: #2c3e50; margin-top: 0; }

/* Прогрес-бар */
.progress-bar { width: 100%; background: #ddd; border-radius: 6px; overflow: hidden; height: 20px; margin-bottom: 20px; }
.progress-fill { height: 100%; background: #2ecc71; width: 0%; text-align: center; color: white; line-height: 20px; font-weight: bold; }

/* Список уроків */
.lesson-topic { margin-bottom: 10px; }
.lesson-topic > h3 { cursor: pointer; margin: 5px 0; }
.lesson-topic ul { list-style: none; padding-left: 15px; display: none; }
.lesson-topic ul li { margin-bottom: 5px; }
.lesson-topic ul li a { text-decoration: none; color: #34495e; }
.lesson-topic ul li.locked { opacity: 0.4; pointer-events: none; }

/* Активний урок */
#content h2 { margin-top: 0; }

button { padding: 5px 10px; cursor: pointer; margin-top: 5px; }
</style>
</head>
<body>

<div id="sidebar">
    <h2>Прогрес курсу</h2>
    <div class="progress-bar">
        <div class="progress-fill" id="course-progress">0%</div>
    </div>

    <div id="lessons-list">
        <!-- Тут JS додасть теми та уроки -->
    </div>
</div>

<div id="content">
    <h1>Ласкаво просимо до курсу Python 9 класу!</h1>
    <p>Виберіть урок зліва, щоб почати навчання.</p>
</div>

<script src="js/course.js"></script>
<script>
// --- Дані уроків та тем ---
const courseData = [
    {
        topic: "Основи Python",
        lessons: [
            {id:"lesson1", title:"Змінні та типи даних"},
            {id:"lesson2", title:"Лінійні алгоритми"}
        ]
    },
    {
        topic: "Алгоритми розгалужень",
        lessons: [
            {id:"lesson3", title:"Алгоритми розгалужень"}
        ]
    }
];

// --- Поточний учень ---
function getCurrentStudent() {
    const email = localStorage.getItem("currentStudent");
    if (!email) return null;
    return email;
}
const current = getCurrentStudent();
if (!current) {
    document.getElementById('content').innerHTML = "<h2>Будь ласка, увійдіть для початку курсу.</h2>";
}

// --- Прогрес ---
const studentData = JSON.parse(localStorage.getItem(`student_${current}`)) || {};
let totalTasks = 0, completedTasks = 0;
courseData.forEach(topic => {
    topic.lessons.forEach(l => {
        const p = studentData[l.id];
        totalTasks += p ? p.totalTasks : 1;
        completedTasks += p ? p.completedTasks : 0;
    });
});
const percent = Math.round((completedTasks / totalTasks) * 100);
const progressEl = document.getElementById("course-progress");
progressEl.style.width = percent + "%";
progressEl.textContent = percent + "%";

// --- Створення списку уроків ---
const lessonsList = document.getElementById("lessons-list");
courseData.forEach(topic => {
    const div = document.createElement("div");
    div.className = "lesson-topic";
    const h3 = document.createElement("h3");
    h3.textContent = topic.topic;
    h3.onclick = () => {
        const ul = div.querySelector("ul");
        ul.style.display = ul.style.display === "none" ? "block" : "none";
    };
    div.appendChild(h3);

    const ul = document.createElement("ul");
    topic.lessons.forEach((lesson, index) => {
        const li = document.createElement("li");
        const a = document.createElement("a");
        a.textContent = lesson.title;

        // Перевірка доступності уроку (попередні уроки повинні бути завершені)
        const prevLessonIndex = courseData.flatMap(t => t.lessons).findIndex(l => l.id === lesson.id) - 1;
        let unlocked = true;
        if (prevLessonIndex >= 0) {
            const prevLessonId = courseData.flatMap(t => t.lessons)[prevLessonIndex].id;
            unlocked = studentData[prevLessonId] && studentData[prevLessonId].completedTasks === studentData[prevLessonId].totalTasks;
        }

        if (!unlocked) {
            li.className = "locked";
        } else {
            a.href = "lessons/" + lesson.id + ".html";
        }

        li.appendChild(a);
        ul.appendChild(li);
    });
    div.appendChild(ul);
    lessonsList.appendChild(div);
});
</script>

</body>
</html>
